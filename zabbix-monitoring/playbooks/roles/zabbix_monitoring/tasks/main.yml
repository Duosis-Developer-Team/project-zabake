---
# Main task file for Zabbix Monitoring role
# PRIMARY MODE: Tag-Based Connectivity Detection
# Legacy template-based tasks moved to legacy/ folder

- name: "Display mode information"
  debug:
    msg: |
      =====================================
      Zabbix Monitoring - Tag-Based Mode
      =====================================
      Using tag-based connectivity detection.
      No configuration files needed!
      See TAG_BASED_CONNECTIVITY_README.md
  when: debug_enabled | default(false) | bool

# ========================================
# PRIMARY: Tag-Based Connectivity Check
# ========================================

- name: "Run tag-based connectivity check"
  include_tasks: tag_based_connectivity_check.yml

- name: "Send email notification"
  include_tasks: send_tag_based_notification_email.yml
  when: send_email | default(true) | bool

# ========================================
# LEGACY MODE (Deprecated)
# ========================================
# Uncomment below to use legacy mode
# WARNING: Will be removed in June 2026
# See LEGACY_DEPRECATION.md

# - name: "⚠️  DEPRECATION WARNING"
#   debug:
#     msg: |
#       =====================================
#       ⚠️  WARNING: LEGACY MODE
#       =====================================
#       Legacy template-based mode is deprecated.
#       Migrate to tag-based mode.
#       See LEGACY_DEPRECATION.md
#
# - include_tasks: legacy/validate_config.yml
#   when: use_legacy_mode | default(false) | bool
#
# - include_tasks: legacy/collect_data.yml
#   when: use_legacy_mode | default(false) | bool
#
# - include_tasks: legacy/detect_connectivity.yml
#   when: use_legacy_mode | default(false) | bool
#
# - include_tasks: legacy/analyze_data.yml
#   when: use_legacy_mode | default(false) | bool
